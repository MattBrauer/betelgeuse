"0","#combine_files(files_betelgeuse, output_filename = output_file_betelgeuse)"
"0",""
"0","if(file_access(data_betelgeuse, ""read"")) raw <- readRDS(data_betelgeuse) else raw <- load_file(output_file_betelgeuse)"
"0",""
"0","raw <- get_new_data(from_date=last_date(raw)) %>%"
"0","  bind_rows(raw) %>%"
"0","  distinct()"
"2","No encoding supplied: defaulting to UTF-8.
"
"0","saveRDS(raw, file = data_betelgeuse)"
"0",""
"0","cleaned <- clean_data(raw)"
"0",""
"0","daily_vis <- cleaned %>%"
"0","  filter(band==""Vis."") %>%"
"0","  daily_magnitude() %>%"
"0","  select(-band) %>%"
"0","  add_dates()"
"0",""
"0","daily_v <- cleaned %>%"
"0","  filter(band==""V"") %>%"
"0","  daily_magnitude() %>%"
"0","  select(-band) %>%"
"0","  add_dates()"
"0",""
"0","multiday <- daily_vis %>%"
"0","  select(day, n_daily_mag) %>%"
"0","  distinct() %>%"
"0","  filter(n_daily_mag > 1) %>%"
"0","  pull(day)"
"0",""
"0","vis_ts <- cleaned %>%"
"0","  filter(band==""Vis."") %>%"
"0","  select(-band) %>%"
"0","  as_tsibble(key = observer, index = jd, regular = FALSE)"
"0",""
"0","v_ts <- cleaned %>%"
"0","  filter(band==""V"") %>%"
"0","  select(-band) %>%"
"0","  as_tsibble(key = observer, index = jd, regular = FALSE)"
"0",""
"0","vvis_ts <- cleaned %>%"
"0","  filter(band==""V"" | band==""Vis."") %>%"
"0","  as_tsibble(key = c(observer, band), index = jd, regular = FALSE)"
"0",""
"0",""
"0",""
"0","daily_vis_ts <- daily_vis %>%"
"0","  select(day, date, mean_daily_mag, sd_daily_mag, n_daily_mag) %>%"
"0","  distinct() %>%"
"0","  as_tsibble(key=NULL, index=day) %>%"
"0","  fill_gaps() %>%"
"0","  mutate(in_run = if_else(is.na(date), FALSE, TRUE),"
"0","         last_of_run = lag(in_run, default = FALSE),"
"0","         next_of_run = lead(in_run, default = FALSE),"
"0","         run_break = in_run & !next_of_run) %>%"
"0","  add_dates()"
"0",""
"0","daily_v_ts <- daily_v %>%"
"0","  select(day, date, mean_daily_mag, sd_daily_mag, n_daily_mag) %>%"
"0","  distinct() %>%"
"0","  as_tsibble(key=NULL, index=day) %>%"
"0","  fill_gaps() %>%"
"0","  mutate(in_run = if_else(is.na(date), FALSE, TRUE),"
"0","         last_of_run = lag(in_run, default = FALSE),"
"0","         next_of_run = lead(in_run, default = FALSE),"
"0","         run_break = in_run & !next_of_run) %>%"
"0","  add_dates()"
"0",""
"0","#reliable <- daily_vis %>% mutate(se = (delta_daily_mag/sd_daily_mag)**2) %>% group_by(observer) %>% summarize(me = mean(se, na.rm=TRUE), n=n()) %>% filter(me <= 1.2) %>% pull(observer)"
